# SHIELD Phase I - INSPECT Checklist
# Orchestrator - Workflow Coordination

name: "Orchestrator INSPECT Checklist"
version: "1.0"
phase: "INSPECT"
description: "Auto-inspeção durante coordenação de workflows"

pre_workflow:
  description: "Checklist antes de iniciar workflow"
  items:
    - id: "I-01"
      check: "Tipo de workflow foi identificado corretamente?"
      critical: true
      examples:
        - "Análise completa (PDF → CSV → Análise)"
        - "Apenas extração (PDF → CSV)"
        - "Apenas análise (CSV → Análise)"

    - id: "I-02"
      check: "Session ID foi gerado seguindo padrão?"
      critical: true
      pattern: "analysis_{edital_id}_{YYYYMMDD}_{HHMMSS}"

    - id: "I-03"
      check: "Diretórios de input/output foram criados?"
      critical: true
      paths:
        - "data/deliveries/{session_id}/inputs/"
        - "data/deliveries/{session_id}/outputs/"

    - id: "I-04"
      check: "Estado inicial da sessão foi criado e salvo?"
      critical: true
      file: "data/state/sessions/{session_id}.json"

    - id: "I-05"
      check: "Plano foi apresentado ao usuário (HALT)?"
      critical: true
      note: "NUNCA executar workflow sem aprovação do usuário"

pre_agent_delegation:
  description: "Checklist antes de delegar para um agente"
  items:
    - id: "I-10"
      check: "Input do agente existe e é válido?"
      critical: true
      examples:
        - "PDF existe para Document Structurer"
        - "CSV de requisitos existe para Technical Analyst"

    - id: "I-11"
      check: "Agente anterior completou com sucesso (se aplicável)?"
      critical: true

    - id: "I-12"
      check: "Estado da sessão foi atualizado com stage atual?"
      critical: true

    - id: "I-13"
      check: "Comando correto do agente foi identificado?"
      critical: true
      examples:
        - "/structure-edital <pdf>"
        - "/analyze-edital <csv>"

post_agent_execution:
  description: "Checklist após agente completar"
  items:
    - id: "I-20"
      check: "Output do agente foi criado?"
      critical: true

    - id: "I-21"
      check: "Output tem formato válido?"
      critical: true
      note: "Usar scripts de validação (validate_csv.py, etc.)"

    - id: "I-22"
      check: "Quantidade de dados é consistente?"
      critical: true
      examples:
        - "Requisitos extraídos > 0"
        - "Total requisitos analisados == Total requisitos extraídos"

    - id: "I-23"
      check: "Estado da sessão foi atualizado com resultado?"
      critical: true

    - id: "I-24"
      check: "Stage foi marcado como completo?"
      critical: true

workflow_transition:
  description: "Checklist ao transicionar entre stages"
  items:
    - id: "I-30"
      check: "Stage anterior está marcado como completed?"
      critical: true

    - id: "I-31"
      check: "Output do stage anterior é input válido do próximo?"
      critical: true

    - id: "I-32"
      check: "Não há erros bloqueantes no histórico?"
      critical: true

error_handling:
  description: "Checklist ao detectar erro"
  items:
    - id: "I-40"
      check: "Erro foi capturado e registrado?"
      critical: true

    - id: "I-41"
      check: "Estado da sessão foi atualizado (status: failed)?"
      critical: true

    - id: "I-42"
      check: "Usuário foi notificado com mensagem clara?"
      critical: true

    - id: "I-43"
      check: "Opções de recuperação foram apresentadas?"
      critical: false
      examples:
        - "Tentar novamente"
        - "Continuar manualmente"
        - "Cancelar análise"

state_management:
  description: "Checklist de gestão de estado"
  items:
    - id: "I-50"
      check: "Sessão foi salva em data/state/sessions/?"
      critical: true

    - id: "I-51"
      check: "Índice foi atualizado em data/state/index.json?"
      critical: true

    - id: "I-52"
      check: "Timestamp de updated_at foi atualizado?"
      critical: true

    - id: "I-53"
      check: "Sessão foi copiada para delivery dir (session.json)?"
      critical: false
      note: "Útil para auditoria, mas não bloqueante"

command_routing:
  description: "Checklist ao processar comandos do usuário"
  items:
    - id: "I-60"
      check: "Comando foi reconhecido?"
      critical: true
      valid_commands:
        - "*ajuda"
        - "*listar_analises"
        - "*sessao [id]"

    - id: "I-61"
      check: "Argumentos foram validados (se necessários)?"
      critical: true

    - id: "I-62"
      check: "Resposta foi formatada de forma clara?"
      critical: false

notes:
  - "Este checklist é usado pelo Orchestrator para auto-inspeção durante execução"
  - "Items marcados como critical: true devem SEMPRE ser verificados"
  - "Se um item critical falhar, PARE e corrija antes de continuar"
  - "Use LOOP para voltar e corrigir problemas antes de avançar"
